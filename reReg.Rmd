---
output: latex_fragment
---
```{R, echo = FALSE, message = FALSE}
library(reReg)
options(width = 60)
data(readmission, package = "frailtypack")
df0 <- subset(readmission, !(id %in% c(60, 109, 280)))
obj <- with(df0, Recur(t.stop, id, event, death))
fn <- Recur(t.stop, id, event, death) ~ chemo
```
	
When the study interest is placed on evaluating the covariate effect on the recurrent event process
and/or the terminal event, the `reReg()` function from the \pkg{reReg} package provides
approaches to fit semiparametric regression model to recurrent event data.
The `reReg()` function offers users options to choose from some of the most common models.
In general, a joint scale-change model for the rate function of the recurrent event process and
the hazard function of the failure time is formulated as follow: 
\begin{equation}
\lambda(t) = Z \lambda_0(te^{X^\top\alpha})e^{X^\top\beta};
h(t) = Z h_0(te^{X^\top\eta})e^{X^\top\theta},
\label{general}
\end{equation}		      
where $Z$ is a latent shared frailty variable to account for association between the two types of
outcomes, $\lambda_0(\cdot)$ is the baseline rate function,
$h_0(\cdot)$ is the baseline hazard function, and the regression coefficients
$(\alpha, \eta)$ and $(\beta, \theta)$ correspond to the shape and size parameters  
of the rate function and hazard function, respectively.
In contrast to usual shared-frailty models that require a parametric assumption on the distribution
of the frailty random variable,
<!--so that the likelihood method can be used to estimate the joint model,-->
the `reReg()` function provides semiparametric estimation procedures that do not require the
knowledge about the frailty as motivated by \citet{wang2001analyzing}.
As a result, the dependence between recurrent events and failure event is left unspecified
and the proposed implementations accommodate informative censoring.

Model \ref{general} allows great flexibility and includes several popular semiparametric models
as special cases.
For examples, the joint Cox model proposed by \citet{huang2004joint} is a special case 
when $\alpha = \eta = 0$ and the joint Accelerated Mean model proposed by \citet{xu2017joint}
is a special case when $\alpha = \eta$.
Moreover, when the primary interest is in the covariate effects on the risk of recurrent
events and treating the terminal event as nuisances, i.e., $\eta = \theta = 0$,
model \ref{general} reduces to the generalized scale-change model proposed
in \citet{xu2019generalized}.
The different model types can be specified via the `method` argument with the
type of rate function and hazard separated by `|`.
For example, setting `method = "cox|cox"` gives the joint Cox model of \citet{huang2004joint}
and `method = "sc|."` gives the generalized scale-change model of \citet{xu2019generalized}.
Other options includes `ar` for the accerlated rate models ($\beta = \theta = 0$)
and `am` for the accerlated mean models.
The following codes fit the joint Cox model and the generalized scale-change model respectively. 
```{R, cache = TRUE}
fit1 <- reReg(fn, data = df0, method = "cox|cox", se = "r")
fit2 <- reReg(fn, data = df0, method = "sc|.", se = "r")
```

